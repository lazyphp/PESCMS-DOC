$(function(){$.refreshToken=function(e){$("input[name=token]").each(function(){$(this).val(e)})},$.ajaxSubmit=function(e){var s={url:"",method:"GET",data:{"":""},dataType:"JSON",timeout:6e4,closeTips:!1,success:function(){},error:function(){},complete:function(){},skipAutoTips:!1,stopJump:!1};Object.assign(s,e);var n={id:"submit-tips",zIndex:"9999",fixed:!0,skin:"submit-warning"};$.ajax({url:s.url,type:s.method,data:s.data,dataType:s.dataType,timeout:s.timeout,beforeSend:function(){$.AMUI.progress.start()},success:function(e){if(200==e.status){if(n.content='<i class="am-icon-check-circle"></i>  ',n.skin="submit-success",0==s.skipAutoTips&&0==s.stopJump){if(-1==e.waitSecond)return window.location.href=e.url,!1;setTimeout(function(){e.url?window.location.href=e.url:location.reload()},2e3)}}else n.content='<i class="am-icon-exclamation-circle"></i>  ';n.content+=e.msg,s.success(e,n)},error:function(e){var t="系统请求出错！请再次提交!";try{switch(e.status){case 0:t=e.statusText;break;case 500:case 404:t=e.responseJSON.msg;break;case 302:dialog({title:"重定向提示",content:'<i class="am-icon-refresh am-icon-spin"></i> '+e.responseJSON.msg,skin:"submit-success",id:"redirectDialog",fixed:!0,okValue:"新窗口打开",ok:function(){return window.open(e.responseJSON.url),!1}}).showModal(),s.error(e,n)}}catch(e){}n.skin="submit-error",n.content='<i class="am-icon-times-circle"></i> '+t,s.error(e,n)},complete:function(e){var t;0==s.skipAutoTips&&(t=dialog(n).showModal(),setTimeout(function(){t.close().remove()},3e3)),s.complete(e,n);var i=$(".refresh-verify").attr("src");$(".refresh-verify").attr("src",i+"&time="+Math.random());try{$.refreshToken(e.responseJSON.token)}catch(e){}$.AMUI.progress.done()}})},$(document).on("submit",".ajax-submit",function(){var e=$(this).attr("action"),t=$(this);return $.ajaxSubmit({url:e,method:"POST",data:t.serialize()}),!1}),$(document).on("click",".ajax-click",function(){var e,t=$(this).attr("data"),i=!1;if($(this).hasClass("am-disabled"))return!1;if($(this).hasClass("ajax-dialog")&&(e=$(this).attr("msg")?$(this).attr("msg"):"确定删除吗？",confirm(e)||(i=!0)),1==i)return!1;i=$('input[name="token"]').val();return $.ajaxSubmit({url:t,data:{token:i}}),!1}),$(document).on("click",".refresh-verify",function(){var e=$(this).attr("src");$(this).attr("src",e+"&time="+Math.random())}),$(document).on("click",".delete-batch",function(){var e=$(this).attr("data"),t=$(".checkbox-all-children").serialize();if(!t)return alert("您没有勾选要删除的数据."),!1;if(confirm("确认进行批量删除所勾选数据吗？")){var i=$('input[name="token"]').val();return $.ajaxSubmit({url:e,method:"POST",data:t+"&token="+i}),!1}return!1});function t(e){for(var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-=_+<>?!@#$%^&&*()",i="",s=e;0<s;--s)i+=t[Math.floor(Math.random()*t.length)];return i}$(".pes-login-secret-key").val(t(16)),$(".secret-key-refresh, .pes-login-secret-key").on("click",function(){var e;$(this).hasClass("pes-login-secret-key")||(e=t(16),$(".pes-login-secret-key").val(e)),$(".pes-login-secret-key").select(),document.execCommand("copy")&&document.execCommand("copy")})});