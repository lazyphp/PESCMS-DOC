$(function(){$.refreshToken=function(e){$("input[name=token]").each(function(){$(this).val(e)})},$.ajaxSubmit=function(e){var c={url:"",method:"GET",data:{"":""},dataType:"JSON",timeout:6e4,closeTips:!1,success:function(){},error:function(){},complete:function(){},skipAutoTips:!1,stopJump:!1};Object.assign(c,e);var o={id:"submit-tips",zIndex:"9999",fixed:!0,skin:"submit-warning"};$.ajax({url:c.url,type:c.method,data:c.data,dataType:c.dataType,timeout:c.timeout,beforeSend:function(){$.AMUI.progress.start()},success:function(e){if(200==e.status){if(o.content='<i class="am-icon-check-circle"></i>  ',o.skin="submit-success",0==c.skipAutoTips&&0==c.stopJump){if(-1==e.waitSecond)return window.location.href=e.url,!1;setTimeout(function(){e.url?window.location.href=e.url:location.reload()},2e3)}}else o.content='<i class="am-icon-exclamation-circle"></i>  ';o.content+=e.msg,c.success(e,o)},error:function(e){var t="系统请求出错！请再次提交!";try{switch(e.status){case 0:t=e.statusText;break;case 500:case 404:t=e.responseJSON.msg;break;case 302:dialog({title:"重定向提示",content:'<i class="am-icon-refresh am-icon-spin"></i> '+e.responseJSON.msg,skin:"submit-success",id:"redirectDialog",fixed:!0,okValue:"新窗口打开",ok:function(){return window.open(e.responseJSON.url),!1}}).showModal(),c.error(e,o)}}catch(e){}o.skin="submit-error",o.content='<i class="am-icon-times-circle"></i> '+t,c.error(e,o)},complete:function(e){var t;0==c.skipAutoTips&&(t=dialog(o).showModal(),setTimeout(function(){t.close().remove()},3e3)),c.complete(e,o);var n=$(".refresh-verify").attr("src");$(".refresh-verify").attr("src",n+"&time="+Math.random());try{$.refreshToken(e.responseJSON.token)}catch(e){}$.AMUI.progress.done()}})},$(document).on("submit",".ajax-submit",function(){var e=$(this).attr("action"),t=$(this);try{if(0<Object.keys(pesMD).length)for(var n in pesMD)$('textarea[name="'+n+'"]').val(pesMD[n].getValue())}catch(e){}return $.ajaxSubmit({url:e,method:"POST",data:t.serialize()}),!1}),$(document).on("click",".ajax-click",function(){var e,t=$(this).attr("data"),n=!1;if($(this).hasClass("am-disabled"))return!1;if($(this).hasClass("ajax-dialog")&&(e=$(this).attr("msg")?$(this).attr("msg"):"确定删除吗？",confirm(e)||(n=!0)),1==n)return!1;n=$('input[name="token"]').val();return $.ajaxSubmit({url:t,data:{token:n}}),!1}),$(document).on("click",".refresh-verify",function(){var e=$(this).attr("src");$(this).attr("src",e+"&time="+Math.random())}),$(".checkbox-all").on("click, change",function(){1==$(this).prop("checked")?$(".checkbox-all-children").prop("checked","checked"):$(".checkbox-all-children").removeAttr("checked")}),$(document).on("click",".delete-batch",function(){var e=$(this).attr("data"),t=$(".checkbox-all-children").serialize();if(!t)return alert("您没有勾选要删除的数据."),!1;if(confirm("确认进行批量删除所勾选数据吗？")){var n=$('input[name="token"]').val();return $.ajaxSubmit({url:e,method:"POST",data:t+"&token="+n}),!1}return!1});function t(e){for(var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-=_+<>?!@#$%^&&*()",n="",c=e;0<c;--c)n+=t[Math.floor(Math.random()*t.length)];return n}$(".pes-login-secret-key").val(t(16)),$(".secret-key-refresh, .pes-login-secret-key").on("click",function(){var e;$(this).hasClass("pes-login-secret-key")||(e=t(16),$(".pes-login-secret-key").val(e)),$(".pes-login-secret-key").select(),document.execCommand("copy")&&document.execCommand("copy")}),$(document).on("click",".pes-copy-command",function(){var e,t=$(this),n=$(this).attr("data");const c=document.createElement("input");return c.setAttribute("value",n),document.body.appendChild(c),c.select(),document.execCommand("copy")&&(t.addClass("am-text-secondary"),document.execCommand("copy"),e=dialog({id:"copy-tips",fixed:!0,skin:"submit-warning",zIndex:"777",content:'<i class="am-icon-check-circle"></i> 复制成功'}).show(),setTimeout(function(){t.removeClass("am-text-secondary"),e.close()},2e3)),document.body.removeChild(c),!1})});