$(function(){$.refreshToken=function(t){$("input[name=token]").each(function(){$(this).val(t)})},$.ajaxSubmit=function(t){var n={url:"",method:"GET",data:{"":""},dataType:"JSON",timeout:6e4,closeTips:!1,success:function(){},error:function(){},complete:function(){},skipAutoTips:!1,stopJump:!1};Object.assign(n,t);var s={id:"submit-tips",zIndex:"9999",fixed:!0,skin:"submit-warning"};$.ajax({url:n.url,method:n.method,data:n.data,dataType:n.dataType,timeout:n.timeout,beforeSend:function(){$.AMUI.progress.start()},success:function(t){if(200==t.status){if(s.content='<i class="am-icon-check-circle"></i>  ',s.skin="submit-success",0==n.skipAutoTips&&0==n.stopJump){if(-1==t.waitSecond)return window.location.href=t.url,!1;setTimeout(function(){t.url?window.location.href=t.url:location.reload()},2e3)}}else s.content='<i class="am-icon-exclamation-circle"></i>  ';s.content+=t.msg,n.success(t,s)},error:function(t){var e="系统请求出错！请再次提交!";try{switch(t.status){case 0:e=t.statusText;break;case 500:case 404:e=t.responseJSON.msg;break;case 302:return s.content='<i class="am-icon-refresh am-icon-spin"></i>  系统将为您重定向新页面...',s.skin="submit-success",setTimeout(function(){window.location.href=t.responseJSON.url},2e3),n.error(t,s),!1}}catch(t){}s.skin="submit-error",s.content='<i class="am-icon-times-circle"></i> '+e,n.error(t,s)},complete:function(t){var e;0==n.skipAutoTips&&(e=dialog(s).showModal(),setTimeout(function(){e.close().remove()},3e3)),n.complete(t,s);var i=$(".refresh-verify").attr("src");$(".refresh-verify").attr("src",i+"&time="+Math.random());try{$.refreshToken(t.responseJSON.token)}catch(t){}$.AMUI.progress.done()}})},$(document).on("submit",".ajax-submit",function(){var t=$(this).attr("action"),e=$(this);return $.ajaxSubmit({url:t,method:"POST",data:e.serialize()}),!1}),$(document).on("click",".ajax-click",function(){var t,e=$(this).attr("data"),i=!1;if($(this).hasClass("am-disabled"))return!1;if($(this).hasClass("ajax-dialog")&&(t=$(this).attr("msg")?$(this).attr("msg"):"确定删除吗？",confirm(t)||(i=!0)),1==i)return!1;i=$('input[name="token"]').val();return $.ajaxSubmit({url:e,data:{token:i}}),!1}),$(document).on("click",".refresh-verify",function(){var t=$(this).attr("src");$(this).attr("src",t+"&time="+Math.random())}),$(document).on("click",".delete-batch",function(){var t=$(this).attr("data"),e=$(".checkbox-all-children").serialize();if(!e)return alert("您没有勾选要删除的数据."),!1;if(confirm("确认进行批量删除所勾选数据吗？")){var i=$('input[name="token"]').val();return $.ajaxSubmit({url:t,method:"POST",data:e+"&token="+i}),!1}return!1});function e(t){for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-=_+<>?!@#$%^&&*()",i="",n=t;0<n;--n)i+=e[Math.floor(Math.random()*e.length)];return i}$(".pes-login-secret-key").val(e(16)),$(".secret-key-refresh, .pes-login-secret-key").on("click",function(){var t;$(this).hasClass("pes-login-secret-key")||(t=e(16),$(".pes-login-secret-key").val(t)),$(".pes-login-secret-key").select(),document.execCommand("copy")&&document.execCommand("copy")})});