$(function(){$.refreshToken=function(e){$("input[name=token]").each(function(){$(this).val(e)})},$.ajaxSubmit=function(e){var i={url:"",method:"GET",data:{"":""},dataType:"JSON",timeout:6e4,closeTips:!1,success:function(){},error:function(){},complete:function(){},skipAutoTips:!1,stopJump:!1};Object.assign(i,e);var s={id:"submit-tips",zIndex:"9999",fixed:!0,skin:"submit-warning"};$.ajax({url:i.url,type:i.method,data:i.data,dataType:i.dataType,timeout:i.timeout,beforeSend:function(){$.AMUI.progress.start()},success:function(e){if(200==e.status){if(s.content='<i class="am-icon-check-circle"></i>  ',s.skin="submit-success",0==i.skipAutoTips&&0==i.stopJump){if(-1==e.waitSecond)return window.location.href=e.url,!1;setTimeout(function(){e.url?window.location.href=e.url:location.reload()},2e3)}}else s.content='<i class="am-icon-exclamation-circle"></i>  ';s.content+=e.msg,i.success(e,s)},error:function(e){var t="系统请求出错！请再次提交!";try{switch(e.status){case 0:t=e.statusText;break;case 500:case 404:t=e.responseJSON.msg;break;case 302:dialog({title:"重定向提示",content:'<i class="am-icon-refresh am-icon-spin"></i> '+e.responseJSON.msg,skin:"submit-success",id:"redirectDialog",fixed:!0,okValue:"新窗口打开",ok:function(){return window.open(e.responseJSON.url),!1}}).showModal(),i.error(e,s)}}catch(e){}s.skin="submit-error",s.content='<i class="am-icon-times-circle"></i> '+t,i.error(e,s)},complete:function(e){var t;0==i.skipAutoTips&&(t=dialog(s).showModal(),setTimeout(function(){t.close().remove()},3e3)),i.complete(e,s);var a=$(".refresh-verify").attr("src");$(".refresh-verify").attr("src",a+"&time="+Math.random());try{$.refreshToken(e.responseJSON.token)}catch(e){}$.AMUI.progress.done()}})},$(document).on("submit",".ajax-submit",function(){var e=$(this).attr("action"),t=$(this);try{if(0<Object.keys(pesMD).length)for(var a in pesMD)$('textarea[name="'+a+'"]').val(pesMD[a].getValue())}catch(e){}return $.ajaxSubmit({url:e,method:"POST",data:t.serialize()}),!1}),$(document).on("click",".ajax-click",function(){var e,t=$(this).attr("data"),a=!1;if($(this).hasClass("am-disabled"))return!1;if($(this).hasClass("ajax-dialog")&&(e=$(this).attr("msg")?$(this).attr("msg"):"确定删除吗？",confirm(e)||(a=!0)),1==a)return!1;a=$('input[name="token"]').val();return $.ajaxSubmit({url:t,data:{token:a}}),!1}),$(document).on("click",".refresh-verify",function(){var e=$(this).attr("src");$(this).attr("src",e+"&time="+Math.random())}),$(document).on("click",".delete-batch",function(){var e=$(this).attr("data"),t=$(".checkbox-all-children").serialize();if(!t)return alert("您没有勾选要删除的数据."),!1;if(confirm("确认进行批量删除所勾选数据吗？")){var a=$('input[name="token"]').val();return $.ajaxSubmit({url:e,method:"POST",data:t+"&token="+a}),!1}return!1});function t(e){for(var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-=_+<>?!@#$%^&&*()",a="",i=e;0<i;--i)a+=t[Math.floor(Math.random()*t.length)];return a}$(".pes-login-secret-key").val(t(16)),$(".secret-key-refresh, .pes-login-secret-key").on("click",function(){var e;$(this).hasClass("pes-login-secret-key")||(e=t(16),$(".pes-login-secret-key").val(e)),$(".pes-login-secret-key").select(),document.execCommand("copy")&&document.execCommand("copy")})});